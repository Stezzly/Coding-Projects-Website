<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThreeJS - Project 3</title>

    <link rel="stylesheet" href="/CSS Themes/HomeStyles/BasicTheme.css">
</head>
<body class="light-mode">

<header class="header-container">
    <div class="header-text">
        <center><h1><i>Project 3 - Updated 3D Model Viewer - HDR</i></h1></center>
    </div>

    <div class="icons-container">
        <a href="index.html" class="icon" aria-label="Computer icon" role="img">&#x1F4BB;</a> 
        <a href="Website/Extra/AboutMe.html" class="icon" aria-label="Book icon" role="img">&#x1F4DA;</a> 
        <a href="Website/Extra/Settings.html" class="icon" aria-label="Settings Icon" role="img">&#x1F6E0;</a>
        <span id="darkModeToggleBtn" class="icon dark-mode-toggle" aria-label="Dark Mode Toggle" role="img">ðŸŒ™</span>
    </div>
</header>

<main>
    <h1>Project 3 - Enhanced 3D Model Viewer with HDR</h1>
    <p>This guide will build on Project 1 - The Three.js 3D Model Viewer by enhancing the visual quality with HDR lighting and allowing for 360-degree rotation of the model.</p>
<br><br>
    <h2>Project Steps</h2>
    <div class="progress-bar-container">
        <div class="progress-bar" style="width: 0%;"></div>
        <div class="progress-text">0%</div>
    </div>
    <br><br><br>
    <button class="collapsible">Step 1: Select a 3D Model</button>
    <div class="content" style="display: none;">
        <label><input type="checkbox" class="step-checkbox"> Done</label>
        <p>Choose a GLB or GLTF model from <a href="https://sketchfab.com" target="_blank">Sketchfab</a> that is suitable for demonstrating HDR effects. Ensure the model is free for web use and has high-quality textures.</p>
    </div>
    <br>
    <button class="collapsible">Step 2: Project Setup</button>
    <div class="content" style="display: none;">
        <label><input type="checkbox" class="step-checkbox"> Done</label>
        <p>Prepare your project by including the necessary Three.js libraries. Set up your HTML and JavaScript files to accommodate HDR lighting. Ensure you have the <code>GLTFLoader.js</code>, <code>OrbitControls.js</code>, and <code>RGBELoader.js</code> added to your project.</p>
    </div>
    <br>
    <button class="collapsible">Step 3: Implement HDR Lighting</button>
    <div class="content" style="display: none;">
        <label><input type="checkbox" class="step-checkbox"> Done</label>
        <p>Load an HDR environment map using <code>RGBELoader</code> to enhance the lighting and appearance of the 3D model. Adjust your scene's lighting settings to utilize the HDR map for both the background and the environment.</p>
    </div>
    <br>
    <button class="collapsible">Step 4: Load and Display the Model</button>
    <div class="content" style="display: none;">
        <label><input type="checkbox" class="step-checkbox"> Done</label>
        <p>Use <code>GLTFLoader</code> to add your chosen model to the scene. Adjust camera and lighting settings for optimal viewing under the new HDR environment.</p>
    </div>
    <br>
    <button class="collapsible">Step 5: Enhance Interaction</button>
    <div class="content" style="display: none;">
        <label><input type="checkbox" class="step-checkbox"> Done</label>
        <p>Update the <code>OrbitControls</code> to enable full 360-degree rotation, enhancing user interaction and experience. Ensure smooth and responsive controls.</p>
    </div>
    <br>
    <button class="collapsible">Step 6: Adjust Camera Settings</button>
    <div class="content" style="display: none;">
        <label><input type="checkbox" class="step-checkbox"> Done</label>
        <p>To focus more closely on your model and enhance its details, adjust the camera's perspective. Change the field of view (FOV) to a narrower angle by setting the camera's perspective to 25. This zooms in on the model and provides a more detailed view. Add the following line to your initialization script:</p>
        <pre><code>camera = new THREE.PerspectiveCamera(25, window.innerWidth / window.innerHeight, 0.1, 1000);</code></pre>
    </div>
</main>


<h2 class="conclusion">Completion</h2>
<p>By following these steps, you have successfully enhanced a basic 3D model viewer into a more dynamic and interactive experience. This viewer now supports full 360-degree rotation and utilizes advanced lighting techniques to better showcase your 3D models.</p>
<p>Admire your work! You've not only set up a functional 3D viewer but also enhanced it with high-quality visual features. This setup forms a solid foundation for further exploration into more complex functionalities like animations, custom shaders, or integration with virtual reality (VR).</p>
<p>We can see that this updated version is a bit better than our previous version, but now with the black background it's extremely difficult to see! We can fix this by adding a very special thing called HDR (High Dynamic Range).
    <br><br>
    HDR is used in many visuals nowadays and it is used to enhance the overall quality of images by increasing the range of color and contrast. This means that lights can appear much brighter, and darks can be deeper, providing a more realistic or vivid scene. In the context of 3D visualization, HDR enhances the lighting environment, allowing for more realistic shadows and highlights that respond dynamically to the lighting conditions defined in the scene.
    <br><br>
    By incorporating HDR into our 3D model viewer, we will improve not only the aesthetic appeal but also the perceptual depth of the models. This makes the viewer more engaging and gives a better representation of how objects interact with light in a real-world setting. It also helps in bringing out the textures and materials of the models, making them look more lifelike and detailed. 
    <br><br>
    To implement HDR in our project, we will utilize HDR environment maps which are pre-compiled panoramic images that store high dynamic range data. When used as the scene's environment background, these maps offer an advanced lighting effect that realistically lights the object, mimicking how light and color would interact in a real-world three-dimensional space.
</p>
<p>In our next project, <a href="/Website/3DModelling/ThreeJS/Beginner/Projects/Project3/Project3.html"> Project 3</a> we will be updating our 3D viewer to contain HDR at attempt for a more aesthetic model.</p>


<h2>Additional Resources</h2>
<ul>
    <li><a href="https://threejs.org/docs/index.html#manual/en/introduction/Creating-a-scene">Three.js Documentation</a> - Explore detailed documentation to deepen your understanding of Three.js and its capabilities.</li>
    <li><a href="https://threejsfundamentals.org">Three.js Fundamentals</a> - A comprehensive resource for beginners and experienced developers alike, covering the fundamentals of Three.js.</li>
    <li><a href="https://learnopengl.com/">Learn OpenGL</a> - While focused on OpenGL, this site provides great insights into graphics programming that can be beneficial for understanding underlying concepts in Three.js.</li>
</ul>


    <h2 class="How to use">How to use</h2>
    <ul>
        <li>Left Mouse Click to rotate the object</li>
        <li>Right Mouse Click to move/transform the objects position</li>
        <li>Middle mouse scroll to zoom in/out on the object</li>
    </ul>
</main>



<footer>
    <a href="/index.html">Continue Learning!</a>
</footer>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var coll = document.getElementsByClassName("collapsible");
        for (var i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                content.style.display = content.style.display === "block" ? "none" : "block";
            });
        }

        var checkboxes = document.querySelectorAll('.step-checkbox');
        var progressBar = document.querySelector('.progress-bar');
        var progressText = document.querySelector('.progress-text');
        var totalSteps = checkboxes.length;
        var completedSteps = 0;

        checkboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                completedSteps += this.checked ? 1 : -1;
                var progressPercentage = (completedSteps / totalSteps) * 100;
                progressBar.style.width = progressPercentage + '%';
                progressText.textContent = Math.round(progressPercentage) + '%';
            });
        });

        var darkModeToggleBtn = document.getElementById('darkModeToggleBtn');
        darkModeToggleBtn.addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
            document.body.classList.toggle('light-mode');
        });
    });
</script>

<section>
    <script src="https://cdn.jsdelivr.net/npm/three@0.126.1/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.126.1/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.126.1/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.126.1/examples/js/loaders/RGBELoader.js"></script>
    <script>
        let scene, camera, renderer, loader, controls;

        function init() {
            // Scene setup
            scene = new THREE.Scene();

            // Camera setup
            camera = new THREE.PerspectiveCamera(25, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            // Renderer setup
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.0;
            document.body.appendChild(renderer.domElement);

            // HDR Environment
            const pmremGenerator = new THREE.PMREMGenerator(renderer);
            pmremGenerator.compileEquirectangularShader();
            new THREE.RGBELoader()
                .setDataType(THREE.UnsignedByteType)
                .load('/Website/3DModelling/HDR/industrial_sunset_02_puresky_4k.hdr', function(texture) {
                    const envMap = pmremGenerator.fromEquirectangular(texture).texture;
                    scene.background = envMap;
                    scene.environment = envMap;
                    texture.dispose();
                    pmremGenerator.dispose();
                });

            // Lighting setup
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(0.5, 0, 0.866); // Adjusted for better illumination
            scene.add(directionalLight);

            // Load GLTF model
            loader = new THREE.GLTFLoader();
            loader.load('/Website/3DModelling/GLB Files/katana_with_dragon.glb', function(gltf) {
                scene.add(gltf.scene);
                updateCameraPosition(gltf.scene);
            }, undefined, function(error) {
                console.error('An error happened:', error);
            });

            // Controls for model interaction
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.1;
            controls.minDistance = 2;
            controls.maxDistance = 10;

            // Window resize handler
            window.addEventListener('resize', onWindowResize, false);
        }

        function updateCameraPosition(model) {
            const box = new THREE.Box3().setFromObject(model);
            const center = box.getCenter(new THREE.Vector3());
            const size = box.getSize(new THREE.Vector3());
            const maxDim = Math.max(size.x, size.y, size.z);
            const fov = camera.fov * (Math.PI / 180);
            let cameraZ = maxDim / 2 / Math.tan(fov / 2);
            cameraZ *= 2; // Double it for good measure
            camera.position.z = cameraZ;
            controls.target = center;
            controls.update();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        init();
        animate();
    </script>
</section>

</body>
</html>






